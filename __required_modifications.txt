REQUIRED MODIFICATIONS TO ParseListens_preGUI.py
================================================

1. Remove or comment out the entire __main__ block at the bottom of the file.
   Lines (approx): 430–460
   Replace:
       if __name__ == "__main__":
           ...
   With:
       # GUI wrapper will call these functions directly.

2. Convert report_top() so it accepts an optional "df" argument that is already
   filtered by the GUI (no change needed — already works).

3. Convert report_artists_threshold() so it accepts mins and tracks from GUI
   (no change needed — already works).

4. Add a new helper function to filter by "days ago" ranges:
   - Time Range (StartDaysAgo, EndDaysAgo)
   - Last Listened Range (StartDaysAgo, EndDaysAgo)
   Add this function anywhere above report_top():
       def filter_by_days(df, col, start_days, end_days):
           ...

5. Ensure normalize_listens() returns listened_at as timezone-aware datetime
   (already correct — no change needed).

6. Ensure save_report() does not auto-run or assume __main__ context
   (already correct — no change needed).

7. No changes required to genre enrichment, caching, or CSV writing.

8. No changes required to report_top() grouping logic.

9. No changes required to the left-justified text formatting in save_report().

SUMMARY:
Only one mandatory modification:
   → Remove the __main__ execution block.
One optional addition:
   → Add a helper function for date-range filtering.
Everything else is GUI-ready.